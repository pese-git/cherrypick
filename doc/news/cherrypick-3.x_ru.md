# Release - CherryPick 3.x

> **CherryPick** ‚Äî –ª—ë–≥–∫–∏–π –∏ –º–æ–¥—É–ª—å–Ω—ã–π DI-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Dart –∏ Flutter, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É —á–µ—Ä–µ–∑ —Å—Ç—Ä–æ–≥—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é, –∫–æ–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

–ù–µ–¥–∞–≤–Ω–æ –≤—ã—à–ª–∞ –≤–µ—Ä—Å–∏—è **3.x**, –≥–¥–µ –ø–æ—è–≤–∏–ª–∏—Å—å –∑–∞–º–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è.


## –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ 3.x

* **O(1) —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** ‚Äî –±–ª–∞–≥–æ–¥–∞—Ä—è Map-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –±–∏–Ω–¥–∏–Ω–≥–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Å–∫–æ—É–ø–∞ –≤ DI –≥—Ä–∞—Ñ–µ. –ù–∞ –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö —ç—Ç–æ –¥–∞—ë—Ç –æ—â—É—Ç–∏–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ.
* **–ó–∞—â–∏—Ç–∞ –æ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ scope, —Ç–∞–∫ –∏ –≤–æ –≤—Å–µ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏. –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —Ü–∏–∫–ª–∞ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å —Ü–µ–ø–æ—á–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
* **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Talker** ‚Äî –≤—Å–µ —Å–æ–±—ã—Ç–∏—è DI (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, —Å–æ–∑–¥–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ, –æ—à–∏–±–∫–∏) –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ –º–æ–≥—É—Ç –≤—ã–≤–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –∏–ª–∏ UI.
* **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤** ‚Äî –æ–±—ä–µ–∫—Ç—ã, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–µ `Disposable`, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ scope.
* **–°—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞** ‚Äî –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞–¥—ë–∂–Ω–µ–µ –∏ —É–¥–æ–±–Ω–µ–µ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö.


## –ü—Ä–∏–º–µ—Ä —Å –æ—á–∏—Å—Ç–∫–æ–π —Ä–µ—Å—É—Ä—Å–æ–≤

```dart
class MyServiceWithSocket implements Disposable {
  @override
  Future<void> dispose() async {
    await socket.close();
    print('Socket –∑–∞–∫—Ä—ã—Ç!');
  }
}

class AppModule extends Module {
  @override
  void builder(Scope currentScope) {
    // singleton Api
    bind<MyServiceWithSocket>()
      .toProvide(() => MyServiceWithSocket())
      .singleton();
  }
}

scope.installModules([AppModule()]);

await CherryPick.closeRootScope(); // –¥–æ–∂–¥—ë—Ç—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è async dispose
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–û–¥–Ω–∞ –∏–∑ –Ω–æ–≤–∏–Ω–æ–∫ CherryPick 3.x ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Ü–∏–∫–ª–æ–≤.
–≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞ —Ä–∞–Ω–Ω–µ–º —ç—Ç–∞–ø–µ –æ—Ç–ª–∞–≤–ª–∏–≤–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–∏—Å—ã –Ω–∞—á–∏–Ω–∞—é—Ç –∑–∞–≤–∏—Å–µ—Ç—å –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ.

### –ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ scope:

```dart
final scope = CherryPick.openRootScope();
scope.enableCycleDetection();
```

–î–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ –≤—Å–µ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏:

```dart
CherryPick.enableGlobalCycleDetection();
CherryPick.enableGlobalCrossScopeCycleDetection();
final rootScope = CherryPick.openRootScope();
```

### –ö–∞–∫ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å —Ü–∏–∫–ª

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ —Å–µ—Ä–≤–∏—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–∏—Å—è—Ç –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞:

```dart
class UserService {
  final OrderService orderService;
  UserService(this.orderService);
}

class OrderService {
  final UserService userService;
  OrderService(this.userService);
}
```

–ï—Å–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –≤ –æ–¥–Ω–æ–º scope:

```dart
class AppModule extends Module {
  @override
  void builder(Scope currentScope) {
    bind<UserService>().toProvide(() => UserService(scope.resolve());
    bind<OrderService>().toProvide(() => OrderService(scope.resolve()));
  }
}

final scope = CherryPick.openRootScope()
  ..enableCycleDetection()
  ..installModules([AppModule()]);

scope.resolve<UserService>();
```

–¢–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –±—É–¥–µ—Ç –≤—ã–±—Ä–æ—à–µ–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ:

```bash
‚ùå Circular dependency detected for UserService
Dependency chain: UserService -> OrderService -> UserService
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ—à–∏–±–∫–∞ –≤—ã—è–≤–ª—è–µ—Ç—Å—è —Å—Ä–∞–∑—É, –∞ –Ω–µ ¬´–≥–¥–µ-—Ç–æ –≤ runtime¬ª.

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Talker

CherryPick 3.x –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–æ–±—ã—Ç–∏—è DI —á–µ—Ä–µ–∑ [Talker](https://pub.dev/packages/talker): —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é, —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤, —É–¥–∞–ª–µ–Ω–∏–µ –∏ –æ—à–∏–±–∫–∏. –≠—Ç–æ —É–¥–æ–±–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –≥—Ä–∞—Ñ–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

–ü—Ä–∏–º–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```dart
final talker = Talker();
final observer = TalkerCherryPickObserver(talker);
CherryPick.setGlobalObserver(observer);
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤ –∫–æ–Ω—Å–æ–ª–∏ –∏–ª–∏ UI –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å–æ–±—ã—Ç–∏—è DI:

```bash
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ [info]    9:41:33  | [scope opened][CherryPick] scope_1757054493089_7072
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÇ [verbose] 9:41:33  | [diagnostic][CherryPick] Scope created: scope_1757054493089_7072 {type: Scope, name: scope_1757054493089_7072, description: scope created}
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
```

–í –ª–æ–≥–µ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å, –∫–æ–≥–¥–∞ scope —Å–æ–∑–¥–∞—ë—Ç—Å—è, –∫–∞–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –∏ —É–¥–∞–ª—è—é—Ç—Å—è, –∞ —Ç–∞–∫–∂–µ –æ—Ç–ª–∞–≤–ª–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏ —Ü–∏–∫–ª—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.


## –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏

–ü–æ–º–∏–º–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –º–æ–¥—É–ª–µ–π, CherryPick –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å DI —á–µ—Ä–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏**.  
–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä—É—á–Ω–æ–π –∫–æ–¥ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª–∏ –∏ mixin –¥–ª—è –∞–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

–ü—Ä–∏–º–µ—Ä –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è:

```dart
@module()
abstract class AppModule extends Module {
  @provide()
  @singleton()
  Api api() => Api();

  @provide()
  Repo repo(Api api) => Repo(api);
}
````

–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ –º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –≤–∏–¥–∂–µ—Ç—ã –∏–ª–∏ —Å–µ—Ä–≤–∏—Å—ã:

```dart
@injectable()
class MyScreen extends StatelessWidget with _$MyScreen {
  @inject()
  late final Repo repo;

  MyScreen() {
    _inject(this);
  }
}
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ: **–ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π (–∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π) —Å —è–≤–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** –∏–ª–∏ **–¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π —á–µ—Ä–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏**.


## –ö–æ–º—É –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω CherryPick?

* –ø—Ä–æ–µ–∫—Ç–∞–º, –≥–¥–µ –≤–∞–∂–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å **–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–∏–∫–ª–æ–≤ –≤ –≥—Ä–∞—Ñ–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**;
* –∫–æ–º–∞–Ω–¥–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç **–º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä—É—á–Ω–æ–π DI-–∫–æ–¥** –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏;
* –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤** (—Å–æ–∫–µ—Ç—ã, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, –ø–æ—Ç–æ–∫–∏).

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

* üì¶ –ü–∞–∫–µ—Ç: [pub.dev/packages/cherrypick](https://pub.dev/packages/cherrypick)
* üíª –ö–æ–¥: [github.com/pese-git/cherrypick](https://github.com/pese-git/cherrypick)
* üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [cherrypick-di.netlify.app](https://cherrypick-di.netlify.app/)